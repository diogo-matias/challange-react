{"ast":null,"code":"import _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nvar _excluded = [\"id\"];\nimport { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport { api } from \"../../services/api\";\nvar initialState = {\n  clientes: [],\n  isLoading: false,\n  error: null,\n  selectedCliente: null\n};\nexport var fetchClientes = createAsyncThunk('clientes/fetchClientes', function () {\n  var _ref2 = _asyncToGenerator(function* (_, _ref) {\n    var rejectWithValue = _ref.rejectWithValue;\n    try {\n      var response = yield api.get('/clientes');\n      var normalizedClientes = response.data.data.clientes.map(function (cliente) {\n        return {\n          id: Math.random(),\n          nomeCompleto: cliente.info.nomeCompleto,\n          email: cliente.info.detalhes.email,\n          dataNascimento: cliente.info.detalhes.nascimento,\n          vendas: cliente.estatisticas.vendas || []\n        };\n      });\n      return normalizedClientes;\n    } catch (error) {\n      var _error$response, _error$response$data;\n      return rejectWithValue(((_error$response = error.response) == null ? void 0 : (_error$response$data = _error$response.data) == null ? void 0 : _error$response$data.message) || 'Erro ao carregar clientes');\n    }\n  });\n  return function (_x, _x2) {\n    return _ref2.apply(this, arguments);\n  };\n}());\nexport var createCliente = createAsyncThunk('clientes/createCliente', function () {\n  var _ref4 = _asyncToGenerator(function* (clienteData, _ref3) {\n    var rejectWithValue = _ref3.rejectWithValue;\n    try {\n      var response = yield api.post('/clientes', clienteData);\n      return response.data;\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n      return rejectWithValue(((_error$response2 = error.response) == null ? void 0 : (_error$response2$data = _error$response2.data) == null ? void 0 : _error$response2$data.message) || 'Erro ao criar cliente');\n    }\n  });\n  return function (_x3, _x4) {\n    return _ref4.apply(this, arguments);\n  };\n}());\nexport var updateCliente = createAsyncThunk('clientes/updateCliente', function () {\n  var _ref6 = _asyncToGenerator(function* (clienteData, _ref5) {\n    var rejectWithValue = _ref5.rejectWithValue;\n    try {\n      var id = clienteData.id,\n        updateData = _objectWithoutProperties(clienteData, _excluded);\n      var response = yield api.patch(`/clientes/${id}`, updateData);\n      return response.data;\n    } catch (error) {\n      var _error$response3, _error$response3$data;\n      return rejectWithValue(((_error$response3 = error.response) == null ? void 0 : (_error$response3$data = _error$response3.data) == null ? void 0 : _error$response3$data.message) || 'Erro ao atualizar cliente');\n    }\n  });\n  return function (_x5, _x6) {\n    return _ref6.apply(this, arguments);\n  };\n}());\nexport var deleteCliente = createAsyncThunk('clientes/deleteCliente', function () {\n  var _ref8 = _asyncToGenerator(function* (id, _ref7) {\n    var rejectWithValue = _ref7.rejectWithValue;\n    try {\n      yield api.delete(`/clientes/test/${id}`);\n      return id;\n    } catch (error) {\n      var _error$response4, _error$response4$data;\n      return rejectWithValue(((_error$response4 = error.response) == null ? void 0 : (_error$response4$data = _error$response4.data) == null ? void 0 : _error$response4$data.message) || 'Erro ao excluir cliente');\n    }\n  });\n  return function (_x7, _x8) {\n    return _ref8.apply(this, arguments);\n  };\n}());\nvar clientesSlice = createSlice({\n  name: 'clientes',\n  initialState: initialState,\n  reducers: {\n    setSelectedCliente: function setSelectedCliente(state, action) {\n      state.selectedCliente = action.payload;\n    },\n    clearSelectedCliente: function clearSelectedCliente(state) {\n      state.selectedCliente = null;\n    },\n    clearError: function clearError(state) {\n      state.error = null;\n    }\n  },\n  extraReducers: function extraReducers(builder) {\n    builder.addCase(fetchClientes.pending, function (state) {\n      state.isLoading = true;\n      state.error = null;\n    }).addCase(fetchClientes.fulfilled, function (state, action) {\n      state.isLoading = false;\n      state.clientes = action.payload;\n    }).addCase(fetchClientes.rejected, function (state, action) {\n      state.isLoading = false;\n      state.error = action.payload;\n    }).addCase(createCliente.fulfilled, function (state, action) {\n      state.clientes.push(action.payload);\n    }).addCase(createCliente.rejected, function (state, action) {\n      state.error = action.payload;\n    }).addCase(updateCliente.fulfilled, function (state, action) {\n      var index = state.clientes.findIndex(function (cliente) {\n        return cliente.id === action.payload.id;\n      });\n      if (index !== -1) {\n        state.clientes[index] = action.payload;\n      }\n    }).addCase(updateCliente.rejected, function (state, action) {\n      state.error = action.payload;\n    }).addCase(deleteCliente.fulfilled, function (state, action) {\n      state.clientes = state.clientes.filter(function (cliente) {\n        return cliente.id !== action.payload;\n      });\n    }).addCase(deleteCliente.rejected, function (state, action) {\n      state.error = action.payload;\n    });\n  }\n});\nvar _clientesSlice$action = clientesSlice.actions,\n  setSelectedCliente = _clientesSlice$action.setSelectedCliente,\n  clearSelectedCliente = _clientesSlice$action.clearSelectedCliente,\n  clearError = _clientesSlice$action.clearError;\nexport { setSelectedCliente, clearSelectedCliente, clearError };\nexport default clientesSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","api","initialState","clientes","isLoading","error","selectedCliente","fetchClientes","_ref2","_asyncToGenerator","_","_ref","rejectWithValue","response","get","normalizedClientes","data","map","cliente","id","Math","random","nomeCompleto","info","email","detalhes","dataNascimento","nascimento","vendas","estatisticas","_error$response","_error$response$data","message","_x","_x2","apply","arguments","createCliente","_ref4","clienteData","_ref3","post","_error$response2","_error$response2$data","_x3","_x4","updateCliente","_ref6","_ref5","updateData","_objectWithoutProperties","_excluded","patch","_error$response3","_error$response3$data","_x5","_x6","deleteCliente","_ref8","_ref7","delete","_error$response4","_error$response4$data","_x7","_x8","clientesSlice","name","reducers","setSelectedCliente","state","action","payload","clearSelectedCliente","clearError","extraReducers","builder","addCase","pending","fulfilled","rejected","push","index","findIndex","filter","_clientesSlice$action","actions","reducer"],"sources":["C:/Users/diogo/OneDrive/Desktop/learning/loja-challenge/frontend/src/store/slices/clientesSlice.ts"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport { ClientesState, CreateClienteData, UpdateClienteData } from '../types';\r\nimport { api } from '../../services/api';\r\n\r\nconst initialState: ClientesState = {\r\n  clientes: [],\r\n  isLoading: false,\r\n  error: null,\r\n  selectedCliente: null,\r\n};\r\n\r\nexport const fetchClientes = createAsyncThunk(\r\n  'clientes/fetchClientes',\r\n  async (_, { rejectWithValue }) => {\r\n    try {\r\n      const response = await api.get('/clientes');\r\n      \r\n      // Normalizar dados da estrutura aninhada\r\n      const normalizedClientes = response.data.data.clientes.map((cliente: any) => ({\r\n        id: Math.random(), // Gerar ID temporÃ¡rio jÃ¡ que nÃ£o estÃ¡ na estrutura aninhada\r\n        nomeCompleto: cliente.info.nomeCompleto,\r\n        email: cliente.info.detalhes.email,\r\n        dataNascimento: cliente.info.detalhes.nascimento,\r\n        vendas: cliente.estatisticas.vendas || []\r\n      }));\r\n      \r\n      return normalizedClientes;\r\n    } catch (error: any) {\r\n      return rejectWithValue(error.response?.data?.message || 'Erro ao carregar clientes');\r\n    }\r\n  }\r\n);\r\n\r\nexport const createCliente = createAsyncThunk(\r\n  'clientes/createCliente',\r\n  async (clienteData: CreateClienteData, { rejectWithValue }) => {\r\n    try {\r\n      const response = await api.post('/clientes', clienteData);\r\n      return response.data;\r\n    } catch (error: any) {\r\n      return rejectWithValue(error.response?.data?.message || 'Erro ao criar cliente');\r\n    }\r\n  }\r\n);\r\n\r\nexport const updateCliente = createAsyncThunk(\r\n  'clientes/updateCliente',\r\n  async (clienteData: UpdateClienteData, { rejectWithValue }) => {\r\n    try {\r\n      const { id, ...updateData } = clienteData;\r\n      const response = await api.patch(`/clientes/${id}`, updateData);\r\n      return response.data;\r\n    } catch (error: any) {\r\n      return rejectWithValue(error.response?.data?.message || 'Erro ao atualizar cliente');\r\n    }\r\n  }\r\n);\r\n\r\nexport const deleteCliente = createAsyncThunk(\r\n  'clientes/deleteCliente',\r\n  async (id: number, { rejectWithValue }) => {\r\n    try {\r\n      await api.delete(`/clientes/test/${id}`);\r\n      return id;\r\n    } catch (error: any) {\r\n      return rejectWithValue(error.response?.data?.message || 'Erro ao excluir cliente');\r\n    }\r\n  }\r\n);\r\n\r\nconst clientesSlice = createSlice({\r\n  name: 'clientes',\r\n  initialState,\r\n  reducers: {\r\n    setSelectedCliente: (state: ClientesState, action) => {\r\n      state.selectedCliente = action.payload;\r\n    },\r\n    clearSelectedCliente: (state: ClientesState) => {\r\n      state.selectedCliente = null;\r\n    },\r\n    clearError: (state: ClientesState) => {\r\n      state.error = null;\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder\r\n      // Fetch Clientes\r\n      .addCase(fetchClientes.pending, (state: ClientesState) => {\r\n        state.isLoading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(fetchClientes.fulfilled, (state: ClientesState, action) => {\r\n        state.isLoading = false;\r\n        state.clientes = action.payload;\r\n      })\r\n      .addCase(fetchClientes.rejected, (state: ClientesState, action) => {\r\n        state.isLoading = false;\r\n        state.error = action.payload as string;\r\n      })\r\n      // Create Cliente\r\n      .addCase(createCliente.fulfilled, (state: ClientesState, action) => {\r\n        state.clientes.push(action.payload);\r\n      })\r\n      .addCase(createCliente.rejected, (state: ClientesState, action) => {\r\n        state.error = action.payload as string;\r\n      })\r\n      // Update Cliente\r\n      .addCase(updateCliente.fulfilled, (state: ClientesState, action) => {\r\n        const index = state.clientes.findIndex(cliente => cliente.id === action.payload.id);\r\n        if (index !== -1) {\r\n          state.clientes[index] = action.payload;\r\n        }\r\n      })\r\n      .addCase(updateCliente.rejected, (state: ClientesState, action) => {\r\n        state.error = action.payload as string;\r\n      })\r\n      // Delete Cliente\r\n      .addCase(deleteCliente.fulfilled, (state: ClientesState, action) => {\r\n        state.clientes = state.clientes.filter(cliente => cliente.id !== action.payload);\r\n      })\r\n      .addCase(deleteCliente.rejected, (state: ClientesState, action) => {\r\n        state.error = action.payload as string;\r\n      });\r\n  },\r\n});\r\n\r\nexport const { setSelectedCliente, clearSelectedCliente, clearError } = clientesSlice.actions;\r\nexport default clientesSlice.reducer; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}